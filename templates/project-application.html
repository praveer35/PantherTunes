<!DOCTYPE html>
<html lang="en" dir="ltr">
   <head>
      <meta charset="utf-8">
      <title>{{ project['title'] }}</title>
      <style>

.bubble {
   width: 100%;
   margin: 0px auto;
   display: block;
   min-height: 250px;
}
.left {
   float: left;
}
.right {
   float: right;
}
#title {
   padding-top: 50px;
}
.subtitle {
   text-align: left;
}
#createbtn {
    font-size: 50px;
    width: 60px;
    height: 60px;
    color: #fff;
    background: linear-gradient(to right, #bd00d6, #e7007fcc);
    border-radius: 100%;
    border: 1px solid black;
    margin-top: -30px;
    /*box-shadow: 4px 4px 4px #444;*/
}
#createbtn:hover {
    color: #bd00d6;
    background: #fff;
    border: 1px solid #e7007fcc;
    /*box-shadow: 2px 2px 2px #e7007fcc;*/
    transition: 0.3s;
    cursor: pointer;
}
#post_update, #important_links, #updates {
   border: 1px solid gray;
   border-radius: 10px;
   padding-left: 20px;
   padding-right: 20px;
}
#post_update {
    float: left;
    width: 30%;
    height: 150px;
}
#important_links {
    margin-top: 20px;
    float: left;
    width: 30%;
    height: 400px;
}
#updates {
    float: right;
    width: 60%;
    height: 800px;
}
.decide {
   float: right;
}

      </style>
   </head>
   <script>

   function decide() {
      var ID = event.target.id;
      var data = {};
      if (ID.charAt(0) == 'a') {
         data = {
            'action': 'accept',
            'application_id': ID.substring(7)
         };
      } else {
         data = {
            'action': 'deny',
            'application_id': ID.substring(5)
         };
      }
      httpGetAsyncPost(window.location.href, decision_made, data);
   }

   function decision_made(data) {
      data = JSON.parse(data);
      if (data['state'] == 'success') {
         window.location.reload();
      } else {
         alert('Error: ' + data['state']);
      }
   }

   function httpGetAsyncPost(theUrl, callback, data){
      //alert(JSON.stringify(data));
      var xmlHttp = new XMLHttpRequest();
      xmlHttp.onreadystatechange = function() {
         if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
            callback(xmlHttp.responseText);
         }
      }
      xmlHttp.open("POST", theUrl, true); // true for asynchronous 
      //alert('c');
      xmlHttp.send(JSON.stringify(data));
      //alert('d');
   }

   </script>
   <body>
      {% extends "template.html" %}
      {% block content %}
      <div class="content" style="width:90%">
         <br>
         <h2 id="title">Applications</h2>
         <div id="sub-nav">
            <ul class="sub-menu">
               <li><a href="{{ url_for('project',project_id=project['project_id']) }}">Feed</a></li>
               <li><a style="color:#fff;" class="highlight" href="{{ url_for('project_application',project_id=project['project_id']) }}">Applications</a></li>
               <li><a href="{{ url_for('project_chat',project_id=project['project_id']) }}">Chat</a></li>
            </ul>
         </div>
         <br><br>
         <div id="updates">
             <p style="font-size:20px;">Updates</p>
             {% for application in applications: %}
             <p>{{ application['username'] }}: {{ application['pitch'] }} 
               {% if project['usernames'].index(session.name) == 0: %}
               <button class="decide" id="deny-{{ application['application_id'] }}" onclick="decide()">N</button>
               <button class="decide" id="accept-{{ application['application_id'] }}" onclick="decide()">Y</button>
               {% endif %}
            </p>
             {% endfor %}
         </div>
         <div id="post_update">
             <p style="font-size:20px;">Post Update</p><br>
             <button id="createbtn">+</button>
         </div>
         <div id="important_links">
             <p style="font-size:20px;">Important Links</p>
         </div>
      </div>
      <br><br><br>
      {% endblock %}
   </body>
</html>